# 八 多态

多态的作用是消除类型之间的耦合关系

### 8.1 再论向上转型

##### 8.1.1 忘记对象类型

如不进行向上转型，则需要为添加的每一个新继承类编写特定类型的方法，大大增加了编程负担

### 8.2 转机

##### 8.2.1 方法调用绑定

前期绑定：编译时把方法调用和方法主体关联

后期绑定：运行时根据对象的类型绑定

Java中除了static方法和final方法，其它所有方法都是后期绑定

##### 8.2.2 产生正确的行为

##### 8.2.3 可扩展性

忽略周围代码发生的变化正是多态所具有的特性

##### 8.2.4 缺陷：“覆盖”私有方法

private方法被自动认为是final方法，无法被覆盖

##### 8.2.5 缺陷：域与静态方法

### 8.3 构造器和多态

##### 8.3.1 构造器的调用顺序

基类-->导出类

##### 8.3.2 继承与清理

##### 8.3.3 构造器内部的多态方法的行为

编写构造器时要用尽可能简单的方法使对象进入正常状态，如果可以的话避免调用其它方法

在构造器中唯一能安全调用的方法是基类中的final方法（不能被覆盖）

### 8.4 协变返回类型

### 8.5 用继承进行设计

准则：用继承表达行为间的差异，并用字段表达状态上的变化

通过组合可以在运行期间获得动态灵活性（状态模式）

##### 8.5.1 纯继承与扩展

导出类中接口的扩展部分不能被基类访问，因此一旦向上转型，就不能调用那些新方法

##### 8.5.2 向下转型与运行时类型识别

RTTI：在运行期间对类型进行检查，如果转型后不是正确的类型，就会返回一个ClassCastException异常